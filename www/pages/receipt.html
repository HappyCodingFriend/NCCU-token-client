<template>
    <section class="page">
        <nav class="navbar">
            <div class="navbar-inner sliding">
                <div class="left">
                    <a href="#" class="link back">
                        <i class="icon icon-back"></i>
                        <span class="ios-only">Back</span>
                    </a>
                </div>
                <div class="title">收款</div>
            </div>
        </nav>
        <div class="page-content">
            <div class="block-title"></div>
            <div class="block block-strong">
                <p>
                    <label class="checkbox">
                        <input type="checkbox" id="brightness">
                        <i class="icon-checkbox"></i>
                    </label>
                    增強亮度
                </p>
                <div id="qrcode"></div>
            </div>
        </div>
    </section>
</template>

<script>
    return {
        methods: {
        },
        on: {
            pageMounted: () => {
                console.log('pageMounted')
            },
            pageInit: () => {
                console.log('pageInit')
                $('#brightness').change(() => {
                    if ($('#brightness').is(':checked')) {
                        brightness.setBrightness(1.0)
                    } else {
                        brightness.setBrightness(-1.0)
                    }
                })

                myReadFile('key.json', (key) => {
                    console.log('keyOnLoadend')

                    let jwt = JSON.parse(atob(storage.getItem('jwt').split('.')[1]))

                    let text = JSON.stringify({
                        ID: jwt.ID,
                        name: jwt.name,
                        address: key.address,
                    })

                    let qrcode = new QRCode('qrcode', {
                        text: text,
                        colorDark: '#000000',
                        colorLight: '#ffffff',
                        correctLevel: QRCode.CorrectLevel.H
                    })
                })
            },
            pageBeforein: () => {
                console.log('pageBeforein')
            },
            pageBeforeOut: () => {
                console.log('pageBeforeOut')
            },
            pageBeforeRemove: () => {
                console.log('pageBeforeRemove')
            },
        },
    }
</script>